# 11.3 Hash Function

一個好的hash function應該不受到input keys的機率分配影響。

其中，key可以是integers、vector或strings。可能為w-bit長度的machine word，或者是更長但長度固定的vector或string，以下先討論短非負整數key。

## static hashing

static hashing只用一個單一固定的hash function，唯一隨機分配的地方只有input keys的機率分配。

### division method

h(k) = k mod m

division methos有以下三個缺點。

1. 不保證平均效能。
2. table大小必須跟除數m一樣大。
3. m必須是一個質數，若m為組合數，如2的x次方，則h(k)將只會只取決於x least significant bit。

### multiply method

h(k) = ⌊m(kA mod 1)⌋

其中，0\<A<1。

multiply method的優點在於，m可以隨意選擇，且m跟乘數A沒有關聯。

### multiply-shift method

首先，我們取table大小m為2的次方，也就是m=2^l，其中l\<w，w為number of bits in machine word。

接著，我們取a = A(2^w)，A在multiply method提過，為0\<A<1。使得0\<a<2^w。

h(k) = (ka mod 2^w) >>> (w - l)

優點為快速，但並不保證有好的平均效能。

## random hashing

當使用static hashing的時候，有人故意選了所有hash value都會相同的inpiut key，這將導致效能不佳。因此，我們可以使用random hash，也就是randomly選一個hash function，這樣的方法叫做random hashing。其中一種方法叫做universal hashing，能在table使用chaning時提供良好的平均效能。

令H做為一個finite family of hash function that map universe U of keys into the range {0, 1, ..., m-1}。若所有使得任意兩不同keys collide的h ∈ H，不超過|H|/m個，則我們稱這個family為universal。也就是任一兩不同key collide的機率**不超過**1/m。

任一uniform independent random family 是universal的，但反之不一定正確。

對一個empty table with m slot做s個操作，包括n = O(m)個insertion、delete跟research，**random hashing保證只需Θ(s)expected time**。

## achivable properties of random hashing

* H為uniform的，若任一key的hash value等於q ∈ {0, 1, ..., m-1}的機率為1/m
* H為universal的，若任兩keys其hash value相同的機率為1/m。
* H為 _Ε - universal_的，若任兩ke兩key其hash value相同的機率為_Ε_。
* H為d - independent的，若任k1, k2, ..., kd，其hash value為不一定相同的q1, q2, ..., qd ∈{0, 1, ..., m-1}，h(ki) = qi的機率為1/(m^d)。

## designing a universal family of hashing

### number theory





